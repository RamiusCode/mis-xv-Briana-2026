---
// Componente de Dedicatoria - Tem√°tica La Princesa y el Sapo
// Para invitaci√≥n de 15 a√±os
// Solo Tailwind - Sin CSS innecesario
---

<!-- DEDICATORIA CON PERGAMINO -->
<section
  class="w-full flex flex-col items-center justify-center py-6 px-4 relative overflow-hidden"
  id="dedicatoria-section"
  style="background: linear-gradient(to bottom, rgba(255, 255, 255, 0) 0%, rgba(98, 106, 84, 0.02) 50%, rgba(255, 255, 255, 0) 100%);"
>
  <!-- Separador Dorado Superior -->
  <div class="w-64 sm:w-40 md:w-96 lg:w-[28rem] xl:w-[32rem] mb-6 z-20" id="separador-dorado">
    <img
      src="/imagenes/SeparadorDorado.webp"
      alt="Separador decorativo dorado"
      class="w-full h-auto object-contain opacity-0"
    />
  </div>

  <!-- Container principal - EXPANDIDO PARA PANTALLAS GRANDES -->
  <div class="relative w-full max-w-sm lg:max-w-sm xl:max-w-sm 2xl:max-w-sm mx-auto">
    
    <!-- Pergamino con texto -->
    <div class="relative z-10" id="pergamino-container" style="perspective: 1000px;">
      <!-- Imagen del pergamino de fondo -->
      <div class="relative opacity-0 drop-shadow-xl" id="pergamino-bg">
        <img
          src="/imagenes/Pergamino.webp"
          alt="Pergamino"
          class="w-full h-auto object-contain"
        />
        
        <!-- Texto sobre el pergamino -->
        <div class="absolute inset-0 flex items-center justify-center px-8 sm:px-12 md:px-16 lg:px-20 xl:px-24">
          <div class="text-center w-full py-8 sm:py-8 lg:py-8 xl:py-8" id="pergamino-text">
            <!-- TEXTO CON ESCALADO COMPLETO -->
            <p class="font-charm font-bold text-xl sm:text-xl md:text-xl lg:text-xl xl:text-xl 2xl:text-xl text-[#8B6914] leading-relaxed opacity-0" style="text-shadow: 0 2px 4px rgba(139, 105, 20, 0.4);">
              Los sue√±os se cumplen y<br />
              hoy uno de los m√≠os se<br />
              hace realidad.<br />
              <span class="block mt-2 sm:mt-3 lg:mt-4 xl:mt-5">
                Con la bendici√≥n de Dios<br />
                y el amor de mi familia,<br />
                te invito a celebrar mis<br />
                <!-- "15 A√ëOS" M√ÅS GRANDE -->
                <span class="font-black text-xl sm:text-2xl md:text-3xl lg:text-4xl xl:text-5xl 2xl:text-6xl">15 a√±os</span>.
              </span>
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Cocodrilo (esquina inferior izquierda) -->
    <div 
      class="absolute -bottom-8 -left-4 sm:-left-8 md:-left-12 lg:-left-16 xl:-left-20 w-20 sm:w-20 md:w-20 lg:w-20 xl:w-20 2xl:w-20 z-20 opacity-0 drop-shadow-md" 
      id="cocodrilo"
    >
      <img
        src="/imagenes/Cocodrilo.webp"
        alt="Cocodrilo Louis"
        class="w-full h-auto object-contain"
      />
    </div>

    <!-- Mosca (lado derecho) -->
    <div 
      class="absolute top-1/3 -right-4 sm:-right-6 md:-right-8 lg:-right-10 xl:-right-12 w-16 sm:w-16 md:w-16 lg:w-16 xl:w-16 2xl:w-16 z-20 opacity-0 drop-shadow-md" 
      id="mosca"
    >
      <img
        src="/imagenes/Mosca.webp"
        alt="Ray la luci√©rnaga"
        class="w-full h-auto object-contain"
      />
    </div>

  </div>
</section>

<!-- SCRIPTS CON GSAP -->
<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  gsap.registerPlugin(ScrollTrigger);

  document.addEventListener("DOMContentLoaded", () => {
    console.log("üìú Iniciando animaci√≥n de dedicatoria...");

    let hasAnimated = false;
    let continuousAnimations = null;

    // Configurar estado inicial
    gsap.set("#separador-dorado img", { opacity: 0, y: -50, scale: 0.8 });
    gsap.set("#pergamino-bg", { opacity: 0, scale: 0.85, y: 30 });
    gsap.set("#pergamino-text p", { opacity: 0, y: 20 });
    gsap.set("#cocodrilo", { opacity: 0, x: -80, y: 20 });
    gsap.set("#mosca", { opacity: 0, x: 80, y: -30 });

    // ScrollTrigger para la animaci√≥n
    ScrollTrigger.create({
      trigger: "#dedicatoria-section",
      start: "top 75%",
      end: "bottom 25%",
      onEnter: () => {
        console.log("üìú ‚ú® Dedicatoria apareciendo...");
        if (!hasAnimated) {
          animateDedicatoria();
          hasAnimated = true;
        }
      },
      onLeave: () => {
        console.log("üìú üëá Usuario sali√≥ hacia abajo");
      },
      onEnterBack: () => {
        console.log("üìú üëÜ Usuario regres√≥ a dedicatoria");
      },
      onLeaveBack: () => {
        console.log("üìú ‚¨ÜÔ∏è Usuario sali√≥ hacia arriba - ocultando...");
        hideAndReset();
      },
    });

    // Animaci√≥n de entrada - TODAS AL MISMO TIEMPO
    function animateDedicatoria() {
      const tl = gsap.timeline();

      tl.to("#separador-dorado img", {
        opacity: 1,
        y: 0,
        scale: 1,
        duration: 1.2,
        ease: "power2.out",
      }, 0)
        .to("#cocodrilo", {
          opacity: 1,
          x: 0,
          y: 0,
          duration: 1.2,
          ease: "power2.out",
        }, 0)
        .to("#mosca", {
          opacity: 1,
          x: 0,
          y: 0,
          duration: 1.2,
          ease: "power2.out",
        }, 0)
        .to("#pergamino-bg", {
          opacity: 1,
          scale: 1,
          y: 0,
          duration: 1.2,
          ease: "power2.out",
        }, 0)
        .to("#pergamino-text p", {
          opacity: 1,
          y: 0,
          duration: 1.2,
          ease: "power2.out",
        }, 0.3);

      tl.call(() => {
        startCharacterAnimations();
      });
    }

    // Ocultar y resetear cuando sube el scroll
    function hideAndReset() {
      if (continuousAnimations) {
        continuousAnimations.kill();
      }

      const tlOut = gsap.timeline({
        onComplete: () => {
          gsap.set("#separador-dorado img", { opacity: 0, y: -50, scale: 0.8 });
          gsap.set("#pergamino-bg", { opacity: 0, scale: 0.85, y: 30 });
          gsap.set("#pergamino-text p", { opacity: 0, y: 20 });
          gsap.set("#cocodrilo", { opacity: 0, x: -80, y: 20 });
          gsap.set("#mosca", { opacity: 0, x: 80, y: -30 });
          hasAnimated = false;
        }
      });

      tlOut.to("#separador-dorado img, #pergamino-bg, #pergamino-text p, #cocodrilo, #mosca", {
        opacity: 0,
        duration: 0.5,
        ease: "power2.in",
      });
    }

    // Animaciones continuas SUTILES
    function startCharacterAnimations() {
      continuousAnimations = gsap.timeline();

      continuousAnimations.to("#mosca", {
        y: -10,
        duration: 3,
        ease: "sine.inOut",
        repeat: -1,
        yoyo: true,
      }, 0);

      continuousAnimations.to("#mosca", {
        x: 5,
        duration: 2.5,
        ease: "sine.inOut",
        repeat: -1,
        yoyo: true,
      }, 0);

      continuousAnimations.to("#mosca", {
        rotation: 5,
        duration: 2.8,
        ease: "sine.inOut",
        repeat: -1,
        yoyo: true,
      }, 0);

      continuousAnimations.to("#pergamino-bg", {
        scale: 1.01,
        duration: 4,
        ease: "sine.inOut",
        repeat: -1,
        yoyo: true,
      }, 0);

      continuousAnimations.to("#cocodrilo", {
        scale: 1.02,
        duration: 3.5,
        ease: "sine.inOut",
        repeat: -1,
        yoyo: true,
      }, 0);
    }
  });
</script>