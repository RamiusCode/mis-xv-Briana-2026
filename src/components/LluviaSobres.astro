---
// LluviaSobres.astro
// Tem√°tica La Princesa y el Sapo
// Lluvia de sobres con QR para transferencias
---

<section class="relative py-8 px-4 overflow-hidden">
  <div class="max-w-4xl mx-auto text-center relative z-10">
    
    <div class="flex justify-center mb-6" id="separador-lluvia">
      <img
        src="/imagenes/SeparadorDos.webp"
        alt="Separador decorativo"
        class="w-40 md:w-40 lg:w-40 h-auto object-contain"
      />
    </div>

    <div class="mb-6" id="titulo-lluvia">
      <h2 class="font-charm text-2xl md:text-2xl lg:text-2xl text-[#D4AF37] font-bold tracking-wide mb-3">
        LLUVIA DE SOBRES
      </h2>
      <p class="font-charm text-xl md:text-xl text-[#6B8E6B] max-w-2xl mx-auto">
      Tu presencia es nuestro mejor regalo, pero si deseas obsequiar algo m√°s, aqu√≠ te dejamos nuestra opci√≥n
      </p>
    </div>

    <div class="flex justify-center max-w-3xl mx-auto mb-8" id="contenedor-qr">
      
      <div class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg p-6 border-2 border-[#D4AF37] w-full md:w-1/2 lg:w-1/2" id="qr-card-1">
        <div class="mb-4">
          <h3 class="font-charm text-xl md:text-xl text-[#D4AF37] font-bold mb-2">
            Banco Nacional
          </h3>
          <p class="font-charm text-sm text-[#6B8E6B]">
            Andrea Guti√©rrez √Ålvarez
          </p>
        </div>
        
        <div class="bg-white rounded-xl p-4 mb-3 flex items-center justify-center">
          <img
            src="/imagenes/QR.webp"
            alt="QR Banco Nacional"
            class="w-48 h-48 object-contain"
          />
        </div>
        
        <p class="font-charm text-xs text-[#6B8E6B]">
          Cuenta: 1234-5678-9012-3456
        </p>
      </div>
      
    </div>

    <div class="mb-4" id="nota-lluvia">
      <p class="font-charm text-xl md:text-xl text-[#D4AF37]">
        Tambi√©n puedes llevar tu sobre el d√≠a del evento
      </p>
    </div>

  </div>

</section>

<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  gsap.registerPlugin(ScrollTrigger);

  if (typeof window !== "undefined") {
    document.addEventListener("DOMContentLoaded", () => {
      console.log("üíå Iniciando animaciones de Lluvia de Sobres...");

      // üéØ ESTADO INICIAL
      gsap.set("#separador-lluvia", { opacity: 0, scale: 0.8 });
      gsap.set("#titulo-lluvia", { opacity: 0, y: 30 });
      gsap.set("#contenedor-qr", { opacity: 0, y: 40 });
      gsap.set("#qr-card-1", { x: 0, rotation: 0, scale: 0.8 }); 
      gsap.set("#nota-lluvia", { opacity: 0, y: 20 });

      // üìç SCROLLTRIGGER
      ScrollTrigger.create({
        trigger: "#separador-lluvia",
        start: "top 80%",
        end: "bottom 20%",
        
        onEnter: () => {
          console.log("‚ú® Secci√≥n de sobres apareciendo...");
          animarEntrada();
        },
        
        onLeaveBack: () => {
          console.log("üëã Ocultando secci√≥n de sobres...");
          animarSalida();
        },
      });

      // üé¨ ANIMACI√ìN DE ENTRADA (Aparecen al mismo tiempo)
      function animarEntrada() {
        const tl = gsap.timeline();
        const duration = 0.8; // Duraci√≥n com√∫n para todos los elementos

        tl.to("#separador-lluvia", {
          opacity: 1,
          scale: 1,
          duration: duration,
          ease: "back.out(1.5)",
        }, 0) // Comienza en el tiempo 0
        .to("#titulo-lluvia", {
          opacity: 1,
          y: 0,
          duration: duration,
          ease: "power3.out",
        }, 0) // Comienza en el tiempo 0
        .to("#contenedor-qr", {
          opacity: 1,
          y: 0,
          duration: duration,
          ease: "power3.out",
        }, 0) // Comienza en el tiempo 0
        .to("#qr-card-1", { 
          scale: 1,
          duration: duration,
          ease: "elastic.out(1, 0.5)",
        }, 0) // Comienza en el tiempo 0
        .to("#nota-lluvia", {
          opacity: 1,
          y: 0,
          duration: duration,
          ease: "power2.out",
        }, 0); // Comienza en el tiempo 0
      }

      // üîô ANIMACI√ìN DE SALIDA (Se mantiene secuencial, pero tambi√©n puedes hacerla simult√°nea usando '0' o '<')
      function animarSalida() {
        const tl = gsap.timeline();

        tl.to("#nota-lluvia, #contenedor-qr, #titulo-lluvia, #separador-lluvia", {
          opacity: 0,
          duration: 0.5,
          ease: "power2.in",
        })
        .to("#qr-card-1", {
          scale: 0.8,
          duration: 0.5,
          ease: "power2.in",
        }, "<");
      }

      console.log("üíå Lluvia de Sobres inicializada");
    });
  }
</script>

<style>
  /* Efecto glassmorphism para las tarjetas */
  #qr-card-1 {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  #qr-card-1:hover {
    transform: translateY(-5px);
    box-shadow: 0 15px 30px rgba(212, 175, 55, 0.3);
  }
</style>

